# Default values for compair.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.
assetLocation: local
enforceSSL: true
cForceRoot: true
secretKey:
existingSecretKeyRef:
existingSecretKeyKey: secret_key
workerSchedulerEnabled: false
demoInstance: false
appLoginEnabled: true
ltiLoginEnabled: false
gaTrackingId: null
loginAdditionalInstructionsHTML: null

imagePullSecrets: []
podAnnotations: {}
podSecurityContext: {}
securityContext: {}
commonAnnotations: {}

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

# celery settings
celery:
  timezone: America/Vancouver
  taskAlwaysEager: false
  workerMaxMemoryPerChild: ""
  workerMaxTasksPerChild: ""

# cas settings
cas:
  enabled: false
  globalUniqueIdentifierField: uid
  server: https://cas.example.com
  authPrefix: /cas
  useSAML: false
  attributeFirstName: firstName
  attributeLastName: lastName
  attributeStudentNumber: studentNumber
  attributeEmail: mail
  attributeUserRole: role
  instructorRoleValues: "instructor teacher staff"
  loginHTML: null

# saml settings
saml:
  enabled: false
  uniqueIdentifier: uid
  globalUniqueIdentifierField: uid
  settings: null
  existingSettingsRef:
  existingSettingsKey: saml_settings
  settingsFile: null
  metadataUrl: "https://saml.example.com/metadata/providers.xml"
  metadataEntityId: "https://saml.example.com/ipd/shibboleth"
  exposeMetadataEndpoint: true
  attributeFirstName: firstName
  attributeLastName: lastName
  attributeStudentNumber: studentNumber
  attributeEmail: mail
  attributeUserRole: role
  instructorRoleValues: "instructor teacher staff"
  loginHTML: null

# email notifications settings
mail:
  enabled: false
  server: https://mail.example.com
  port: "1025"
  useSSL: true
  useTLS: false
  username: compair
  password:
  existingPasswordRef:
  existingPAsswordKey: mail_password
  defaultSender: compair@example.com

# attachment
attachment:
  uploadLimit: &uploadLimit "262144000" #1024 * 1024 * 250 -> max 250MB
  allowedExtensions: "pdf mp3 mp4 webm jpg jpeg png"
  previewExtensions: "jpg jpeg png"

# kaltura media attachments settings
kaltura:
  enabled: false
  useGlobalUniqueIdentifier: false
  serviceURL: https://kaltura.example.com
  partnerId: "1234"
  secret:
  existingSecretRef:
  existingSecretKey: kaltura_secret
  userId: "1234"
  playerId: "1234"
  videoExtensions: "mp4 mov webm"
  audioExtensions: "mp3"

# LRS settings
lrs:
  xapi:
    enabled: false
    statementEndpoint: https://lrs.example.com/data/xAPI/
    username: lrs
    password:
    existingPasswordRef:
    existingPasswordKey: xapi_password
  caliper:
    enabled: false
    host: https://lrs.example.com/data/caliper/
    api_key:
    existingApiKeyRef:
    existingApiKeyKey: caliper_api_key
  appBaseURL: https://archive.org/services/purl/compair/ctlt/
  actorAccountUseGlobalUniqueIdentifier: false
  actorAccountGlobalUniqueIdentifierHomepage: http://www.example.com/
  userInputFieldSizeLimit: "10000" #10,000 characters

# data privacy settings
expose:
  emailToInstructor: false
  casUsernameToInstructor: false

# profile editing controls
allowStudentChange:
  name: 1
  displayName: 1
  studentNumber: 1
  email: 1

app:
  replicaCount: 1
  image:
    repository: ubcctlt/compair-app
    tag:
    pullPolicy: IfNotPresent
  persistence:
    enabled: false
    annotations: {}
    # auto provision
    storageClass:
    accessMode: ReadWriteOnce
    size: 10Gi
    # NFS
    #accessMode: ReadWriteMany
    #resources:
    #  nfs:
    #    server: NSF_SERVER_IP
    #    path: "/export/data/compair"
  service:
    type: ClusterIP
    externalPort: 80
    internalPort: 3031
  ingress:
    enabled: true
    class:
    hosts: []
    # - compair.example.com
    annotations:
      kubernetes.io/tls-acme: "true"
      nginx.ingress.kubernetes.io/proxy-body-size: *uploadLimit
  resources:
    limits:
    #  cpu: 100m
      memory: 512Mi
    requests:
    #  cpu: 100m
      memory: 256Mi

worker:
  replicaCount: 1
  image:
    repository: ubcctlt/compair-app
    tag: latest
    pullPolicy: IfNotPresent
  resources:
    limits:
    #  cpu: 100m
      memory: 800Mi
    requests:
    #  cpu: 100m
      memory: 512Mi

scheduler:
  resources:
    limits:
    #  cpu: 100m
      memory: 100Mi
    requests:
    #  cpu: 100m
      memory: 64Mi

## DB chart configuration
##
db:
  ## @param db.enabled Deploy a MariaDB server to satisfy the application database requirements
  ## To use an external database set this to false and configure the `externalDatabase.*` parameters
  ##
  enabled: true

  ## @param mariadb.architecture MariaDB architecture. Allowed values: `standalone` or `replication`
  ##
  architecture: replication
  ## MariaDB Authentication parameters
  ## @param mariadb.auth.rootPassword MariaDB root password
  ## @param mariadb.auth.database MariaDB custom database
  ## @param mariadb.auth.username MariaDB custom username
  ## @param mariadb.auth.password MariaDB custom user password
  ##
  auth:
    rootPassword:
    database: compair
    username: compair
    password:

  connOptions: '{"charset":"utf8mb4"}'

## External Database Configuration
## All of these values are only used if `mariadb.enabled=false`
##
externalDatabase:
  ## @param externalDatabase.host External Database server host
  ##
  host: localhost
  ## @param externalDatabase.port External Database server port
  ##
  port: 3306
  ## @param externalDatabase.user External Database username
  ##
  user: compair
  ## @param externalDatabase.password External Database user password
  ##
  password: ""
  ## @param externalDatabase.database External Database database name
  ##
  database: compair
  ## @param externalDatabase.existingSecret The name of an existing secret with database credentials. Evaluated as a template
  ## NOTE: Must contain key `mariadb-password`
  ## NOTE: When it's set, the `externalDatabase.password` parameter is ignored
  ##
  existingSecret: ""

redis:
  image:
    repository: redis
    tag: 3.2.11
    pullPolicy: IfNotPresent
  service:
    port: 6379
  persistence:
    enabled: false
    annotations: {}
    storageClass:
    accessMode: ReadWriteOnce
    size: 1Gi
  resources:
    limits:
    #  cpu: 100m
      memory: 100Mi
    requests:
    #  cpu: 100m
      memory: 64Mi
